# Hammerspoon 大麦抢票神器 🎯

一个基于 [Hammerspoon](https://www.hammerspoon.org/) 的智能抢票工具，专为大麦网演出票务抢购优化。**从基础连点器进化为智能学习系统**，能够实时适应各种抢票场景和错误处理。

---

## 🆕 v2.0 重大升级（2025-05）

> ✨ **从1.0基础版进化为2.0智能学习版，核心算法全面重构**  
> 🤖 **本次升级由 Claude 4 Sonnet 深度参与算法设计与优化，实现智能学习系统的突破性创新**

### 🧠 核心新特性

#### **智能学习系统**
- 🎯 **动态坐标学习**：抢票过程中实时学习错误按钮位置
- 🔄 **无限次更新**：每次遇到新错误都能立即学会
- ⚡ **零延迟生效**：学习后下一次循环立即应用
- 🛡️ **渐进式智能**：从安全模式逐步升级到全自动模式

#### **专业抢票策略**
- 🎮 **双模式运行**：未学习时安全点击，学习后智能处理
- 🔥 **疯狂点击频率**：默认20次/秒，可调节至50次/秒
- 🎯 **错误优先处理**：基于实战经验的点击节奏优化
- 📊 **实时状态监控**：点击统计、运行时间、学习进度

#### **用户体验升级**
- ⌨️ **简化快捷键**：去除Command键，只需Option+字母
- 🚀 **一键操作**：记录、学习、启停一步到位
- 📱 **智能提示**：详细的操作引导和状态反馈
- 🛡️ **多重保护**：超时停止、紧急停止、安全检查

---

## 🎮 v2.0 vs v1.0 对比

| 功能特性 | v1.0 基础版 | v2.0 智能版 | 升级说明 |
|---------|-------------|-------------|----------|
| **坐标管理** | 手动预设固定坐标 | 🧠 **智能学习+动态更新** | 可实时学习任意错误弹窗位置 |
| **错误处理** | 预设"继续尝试"按钮 | 🎯 **无限错误类型学习** | 支持所有类型错误弹窗 |
| **抢票策略** | 固定比例点击 | ⚡ **双模式智能切换** | 根据学习状态自动优化策略 |
| **快捷键** | Option+Command组合 | 🚀 **简化为Option单键** | 操作更快速便捷 |
| **适用场景** | 通用连点工具 | 🎪 **专为大麦抢票优化** | 基于真实抢票场景设计 |
| **状态监控** | 基础计数显示 | 📊 **详细统计+学习状态** | 实时反馈所有关键信息 |
| **性能优化** | 标准事件处理 | ⚡ **高性能+安全检查** | 更稳定、更快速 |

---

## 📦 系统要求

### **macOS 用户**
- macOS 15 或更高版本  
- [Hammerspoon](https://www.hammerspoon.org/) 已安装并获得"辅助功能"权限
- iPhone镜像功能（System Settings > iPhone Mirroring）

### **Windows 用户**
- 任何支持屏幕投影的Windows版本
- 能够进行自动化点击的工具（如AutoHotkey、Python等）
- 手机投屏软件（如scrcpy、ApowerMirror等）

### **通用适用性**
> 💡 **重要说明**：本项目**不仅限于Mac**！只要你能将手机屏幕投射到电脑并进行坐标点击，就可以使用：
> - **Mac**: iPhone镜像 + Hammerspoon
> - **Windows**: 投屏软件 + AutoHotkey/Python
> - **Linux**: 投屏软件 + 自动化脚本
> - **Android**: 任何平台 + scrcpy等投屏工具

---

## 🚀 安装方法

### **方法一：使用v2.0智能版（推荐）**

1. 安装 [Hammerspoon](https://github.com/Hammerspoon/hammerspoon/releases)
2. 打开Hammerspoon并获得"辅助功能"权限
3. 下载 `damai_ticket_grabber.lua` 
4. 在Hammerspoon Console中运行该脚本

### **方法二：使用v1.0基础版**

1. 将 `init.lua` 放入 `~/.hammerspoon/` 目录
2. 在菜单栏点击"Reload Config"重新加载配置

---

## ⚡ v2.0 使用教程

### **🎯 快捷键一览**

```
Option + R : 记录主按钮位置 🎯
Option + E : 智能学习错误按钮 🧠  
Option + G : 开始抢票 🚀
Option + S : 停止抢票 ⏹️
Option + Q : 紧急停止 🚨
Option + I : 显示状态 📊
Option + D : 切换调试模式 🔧
```

### **🎪 实战抢票流程**

#### **第一步：准备阶段**
1. 打开iPhone镜像，进入大麦App选票页面
2. 将鼠标移动到"提交抢票预约"按钮上
3. 按 `Option + R` 记录主按钮位置

#### **第二步：开始抢票**
1. 等到开抢时间前几秒
2. 按 `Option + G` 开始疯狂抢票
3. 脚本进入**安全模式**，只点击主按钮

#### **第三步：智能学习**
1. 当出现第一个错误弹窗时：
   - 手动点击"继续尝试"或"返回重试"
   - 立即按 `Option + E` 学习该位置
2. 脚本自动升级为**智能模式**
3. 后续错误全部自动处理

#### **第四步：持续优化**
1. 遇到新类型错误弹窗
2. 继续使用 `Option + E` 学习新位置
3. 脚本实时更新处理策略

#### **第五步：成功结束**
1. 看到支付页面立即按 `Option + S` 停止
2. 或遇到问题时按 `Option + Q` 紧急停止

### **🧠 智能学习原理**

```
启动抢票 → 安全模式(只点主按钮)
    ↓
遇到错误 → 手动处理 + Option+E学习
    ↓  
智能模式 → 主按钮+错误处理自动循环
    ↓
新错误 → Option+E再次学习 → 更新策略
    ↓
无限适应各种抢票场景
```

---

## ⚙️ 性能调优

### **点击频率设置**

在 `damai_ticket_grabber.lua` 第15行修改：

```lua
-- 不同性能等级选择
clickInterval = 0.02,    -- 🔥 超疯狂：50次/秒 (高性能电脑)
clickInterval = 0.05,    -- ⚡ 疯狂模式：20次/秒 (推荐默认)
clickInterval = 0.1,     -- 🚀 快速模式：10次/秒 (一般电脑)
clickInterval = 0.2,     -- ⚖️ 稳定模式：5次/秒 (保守选择)
```

### **M3 MacBook Pro优化建议**
- 推荐使用 `0.02` 超疯狂模式（50次/秒）
- 性能强劲，完全可以支持最高频率
- 配合智能学习系统，抢票成功率最高

---

## 📊 版本功能对比

| 文件名 | 版本 | 适用场景 | 核心特点 |
|--------|------|----------|----------|
| `damai_ticket_grabber.lua` | **v2.0 智能版** ⭐ | 大麦抢票专用 | 智能学习、动态适应、专业优化 |
| `init.lua` | v1.0 基础版 | 通用连点工具 | 简单易用、功能基础、适合初学者 |

> 💡 **使用建议**：新用户直接使用v2.0智能版，功能更强大且针对抢票场景深度优化

---

## 🛠️ 技术特性

### **v2.0 核心技术升级**

- **🧠 动态坐标系统**：支持运行时实时更新坐标
- **⚡ 高性能事件处理**：预创建事件对象，零延迟响应
- **🛡️ 安全状态管理**：多层检查机制，防止异常
- **📊 智能统计系统**：实时监控性能和学习状态
- **🔧 调试支持**：可开关的详细日志系统

### **兼容性保障**

- **Hammerspoon 1.0.0+**: 兼容所有主流版本
- **macOS 15+**: 完整支持iPhone镜像功能
- **跨平台思路**: 提供其他平台实现参考

---

## 🎯 实战建议

### **抢票成功率提升技巧**

1. **🕐 提前准备**：开抢前5分钟完成所有设置
2. **🧠 预先学习**：如果知道常见错误，可提前学习位置  
3. **⚡ 最优频率**：根据网络状况选择合适的点击频率
4. **🎯 精确坐标**：仔细对准按钮中心记录坐标
5. **🚨 快速响应**：看到支付页面立即停止脚本

### **常见问题解决**

- **坐标不准**：重新用Option+R记录主按钮位置
- **错误处理失效**：用Option+E重新学习错误按钮位置  
- **点击太快被限制**：调低clickInterval数值
- **脚本无响应**：Option+Q紧急停止后重新启动

---

## 📈 更新记录

### **v2.0.0 (2025-05-30) - 智能学习版** 🎉
- ✨ **新增智能学习系统**：动态错误处理能力
- 🚀 **重构快捷键系统**：简化为Option单键操作
- ⚡ **专业抢票优化**：基于实战经验的策略调整
- 🧠 **实时坐标更新**：抢票过程中零延迟学习
- 📊 **增强状态监控**：详细的统计和反馈系统
- 🛡️ **安全性提升**：多重检查和保护机制
- 🤖 **AI算法优化**：Claude 4 Sonnet 提供核心智能学习算法与架构设计

### **v1.0.0 (2025-05-21) - 基础版**
- 🎯 基础自动连点功能
- 📱 支持iPhone镜像操作
- ⚙️ 可配置点击间隔和时长
- 🔄 "继续尝试"按钮支持
- ⌨️ 基础快捷键操作

---

## 📄 文件说明

```
📂 项目结构
├── 📄 README.md                    # 项目说明文档
├── 🎯 damai_ticket_grabber.lua     # v2.0 智能学习版 (推荐)
├── 📜 init.lua                     # v1.0 基础版 (备用)
└── 📝 LICENSE                      # MIT开源协议
```

---

## 📜 许可证

MIT License - 自由使用、修改和分发

---

## ⭐ 贡献与支持

如果这个项目对你有帮助，请给个Star⭐支持！

**原始作者**：@Eric  
**v2.0 智能升级**：Claude 4 Sonnet 深度参与算法架构设计  
**AI技术贡献**：
- 🧠 智能学习算法的核心逻辑设计
- 🎯 抢票场景的策略优化与错误处理机制
- ⚡ 高性能事件处理架构的技术实现
- 🛡️ 安全状态管理与异常处理的完整方案

**适用平台**：macOS, Windows, Linux (配合相应自动化工具)

> 💡 **项目理念**：让技术为抢票服务，用智能化解决重复劳动，把更多时间留给享受演出本身！  
> 🤖 **AI价值**：Claude 4 Sonnet 将复杂的抢票场景转化为智能学习系统，实现从"被动应对"到"主动适应"的技术跃迁！

---

**祝你抢票成功，演出愉快！** 🎉